scenario: log-anomaly-triage
tools_enabled:
  - read_file
  - python_repl
  - search_knowledge_base
coordination_pattern: planner_executor_verifier
max_cycles: 1
memory_limit: 10
max_steps: 4
stop_signals: ["done", "完成"]
# max_elapsed_sec: 20  # Optional cumulative tool time budget (seconds)
# graph_template: "mypkg.graphs:log_flow"  # Optional custom graph template
initial_instructions:
  - "读取 logs/app.log，识别 500/4xx 错误的异常峰值，按时间段汇总次数，并给出可能原因假设和排查优先级。"
files:
  logs/app.log: |
    2024-05-01T10:00:00Z GET /health 200 12ms
    2024-05-01T10:01:00Z POST /login 302 25ms
    2024-05-01T10:02:00Z GET /api/data 500 210ms
    2024-05-01T10:02:03Z GET /api/data 500 215ms
    2024-05-01T10:02:06Z GET /api/data 500 198ms
    2024-05-01T10:05:00Z GET /static/app.js 200 8ms
    2024-05-01T10:06:00Z GET /api/data 200 45ms
    2024-05-01T10:07:00Z GET /api/data 429 5ms
    2024-05-01T10:07:02Z GET /api/data 429 4ms
    2024-05-01T10:10:00Z GET /api/data 500 220ms
    2024-05-01T10:10:02Z GET /api/data 500 230ms
    2024-05-01T10:10:05Z GET /api/data 500 225ms
  notes.md: |
    - 聚焦 500/4xx 错误的短时集中；尝试解释/假设（发布回滚、上游依赖、速率限制等）。
    - 输出：表格（时间段、状态码、次数）、关键假设、下一步排查项。
agents:
  - name: planner
    mode: llm
    system_prompt: "制定日志分析计划，不调用工具。输出编号步骤，覆盖读取日志、按时间窗口统计、识别异常峰值和需要的额外证据。"
    tools_allowed: []
  - name: executor
    mode: llm
    system_prompt: "按照计划执行：用 read_file 查看日志，用 python_repl 统计状态码与时间段峰值，必要时用 search_knowledge_base 获取常见根因。输出发现与假设。"
    tools_allowed: [read_file, python_repl, search_knowledge_base]
  - name: verifier
    mode: rule
    system_prompt: "检查输出是否包含：按时间段的 500/4xx 统计、明显峰值说明、假设与下一步排查。满足则回复 DONE。"
    tools_allowed: []
